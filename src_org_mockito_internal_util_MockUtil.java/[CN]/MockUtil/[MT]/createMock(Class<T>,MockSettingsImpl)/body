{
  creationValidator.validateType(classToMock);
  creationValidator.validateExtraInterfaces(classToMock,settings.getExtraInterfaces());
  creationValidator.validateMockedType(classToMock,settings.getSpiedInstance());
  InvocationNotifierHandler<T> mockHandler=new InvocationNotifierHandler<T>(new MockHandler<T>(settings),settings);
  Class<?>[] extraInterfaces=prepareAncillaryTypes(settings);
  T mock=mockMaker.createMock(classToMock,extraInterfaces,mockHandler,settings);
  Object spiedInstance=settings.getSpiedInstance();
  if (spiedInstance != null) {
    new LenientCopyTool().copyToMock(spiedInstance,mock);
  }
  return mock;
}
