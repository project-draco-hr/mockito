{
  if (settings.getSerializableMode() == SerializableMode.ACROSS_CLASSLOADERS) {
    throw new MockitoException("Serialization across classloaders not yet supported with ByteBuddyMockMaker");
  }
  Class<? extends T> mockedType=cachingMockBytecodeGenerator.get(settings.getTypeToMock(),settings.getExtraInterfaces());
  T mock=classInstantiator.instantiate(mockedType);
  MockMethodInterceptor.MockAccess mockAccess=(MockMethodInterceptor.MockAccess)mock;
  mockAccess.setMockitoInterceptor(new MockMethodInterceptor(asInternalMockHandler(handler),settings));
  return ensureMockIsAssignableToMockedType(settings,mock);
}
