{
  InvocationListener listener=mock(InvocationListener.class);
  RuntimeException expectedException=new ThirdPartyException();
  Foo foo=mock(Foo.class,withSettings().invocationListeners(listener));
  doThrow(expectedException).when(foo).doSomething("argument");
  try {
    foo.doSomething("argument");
    fail("Exception expected.");
  }
 catch (  ThirdPartyException actualException) {
    assertSame(expectedException,actualException);
    verify(listener).reportInvocation(isA(MethodCallReport.class));
  }
}
