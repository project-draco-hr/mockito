{
  if (o == null || !(o instanceof Map)) {
    return false;
  }
  Map other=(Map)o;
  if (size() != other.size()) {
    return false;
  }
  for (Iterator it=keySet().iterator(); it.hasNext(); ) {
    Object key=it.next();
    if (!other.containsKey(key)) {
      return false;
    }
    Object v1=get(key);
    Object v2=other.get(key);
    if (!((v1 == null) ? v2 == null : v1.equals(v2))) {
      return false;
    }
  }
  return true;
}
