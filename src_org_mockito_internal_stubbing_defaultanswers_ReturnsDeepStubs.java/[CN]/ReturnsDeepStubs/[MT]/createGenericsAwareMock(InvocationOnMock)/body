{
  Type genericReturnType=invocation.getMethod().getGenericReturnType();
  if (genericReturnType instanceof Class) {
    return mock((Class<?>)genericReturnType,this);
  }
  MockitoGenericMetadata mockitoGenericMetadata=actualParameterizedType(invocation.getMock()).resolveGenericReturnType(invocation.getMethod());
  return mockitoGenericMetadata.toMock(this);
}
