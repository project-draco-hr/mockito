{
  Enhancer enhancer=new Enhancer(){
    @SuppressWarnings("unchecked") protected void filterConstructors(    Class sc,    List constructors){
      CollectionUtils.filter(constructors,new VisibilityPredicate(sc,true));
    }
  }
;
  if (toMock.isInterface()) {
    enhancer.setInterfaces(new Class[]{toMock});
  }
 else {
    enhancer.setSuperclass(toMock);
  }
  if (toMock.getSigners() != null) {
    enhancer.setNamingPolicy(ALLOWS_MOCKING_CLASSES_IN_SIGNED_PACKAGES);
  }
  enhancer.setClassLoader(SearchingClassLoader.combineLoadersOf(toMock));
  return enhancer;
}
